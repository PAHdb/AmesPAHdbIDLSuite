<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.3 on Wed Nov 22 14:48:42 2023 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>stellar_kurucz_model.pro (AmesPAHdbIDLSuite Manual)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="../idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="../idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="stellar_kurucz_model.pro (AmesPAHdbIDLSuite Manual)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="container">
      <div class="content">
	<code class="source"><span class="comments">; docformat = 'rst'</span>

<span class="comments">;+</span>
<span class="comments">;</span>
<span class="comments">; This is an example of creating an astronomical PAH emission spectrum</span>
<span class="comments">; using a Kurucz stellar model for excitination, built around the</span>
<span class="comments">; functionality provided by the AmesPAHdbIDLSuite and should help</span>
<span class="comments">; confirm that the it has been properly installed. The source code is</span>
<span class="comments">; annotated to guide users and developers in the inner workings of the</span>
<span class="comments">; suite.</span>
<span class="comments">;</span>
<span class="comments">; Updated versions of the NASA Ames PAH IR Spectroscopic Database and</span>
<span class="comments">; more information can be found at: `www.astrochemistry.org/pahdb &lt;https://www.astrochemistry.org/pahdb>`.</span>
<span class="comments">;</span>
<span class="comments">; :Examples:</span>
<span class="comments">;   Call the procedure directly::</span>
<span class="comments">;</span>
<span class="comments">;     IDL> stellar_kurucz_model</span>
<span class="comments">;</span>
<span class="comments">; :Author:</span>
<span class="comments">;   Dr. Christiaan Boersma</span>
<span class="comments">;</span>
<span class="comments">; :Copyright:</span>
<span class="comments">;   BSD licensed</span>
<span class="comments">;</span>
<span class="comments">; :History:</span>
<span class="comments">;   Changes::</span>
<span class="comments">;</span>
<span class="comments">;     08-19-2019</span>
<span class="comments">;     Documentation added. Christiaan Boersma.</span>
<span class="comments">;-</span>

<span class="comments">;+</span>
<span class="comments">; Procedure creating an astronomical PAH emission spectrum using a</span>
<span class="comments">; Kurucz stellar model for excitination.</span>
<span class="comments">;</span>
<span class="comments">; :Categories:</span>
<span class="comments">;   Example</span>
<span class="comments">;-</span>
PRO STELLAR_KURUCZ_MODEL

  <span class="comments">; read in the default database defined by the environement variable</span>
  <span class="comments">; !AMESPAHDEFAULTDB or the system variable AMESPAHDEFAULTDB. use the</span>
  <span class="comments">; keyword FILENAME if these have not been set</span>
  pahdb = OBJ_NEW('AmesPAHdbIDLSuite')

  <span class="comments">; use the unique identifier for coronene</span>
  uid = 18

  <span class="comments">; retrieve the transitions from the database</span>
  transitions = pahdb->getTransitionsByUID(uid)

  <span class="comments">; load Kurucz stellar model</span>
  FTAB_EXT,'ckp00_17000.fits',[1,10],angstroms,flem,EXT=1

  <span class="comments">; block under/overflow</span>
  e = !EXCEPT

  !EXCEPT = 0

  <span class="comments">; include the temperature cascade</span>
  transitions->Cascade, $
     AMESPAHDBIDLSUITE_CREATE_KURUCZ_STELLARMODEL_S(angstroms, flem), $
     /Star, $
     /StellarModel, $
     /Convolved

  <span class="comments">; shift data 15 wavenumber to the red</span>
  transitions->Shift,-15D

  <span class="comments">; convolve stick spectrum</span>
  spectrum = transitions->Convolve(FWHM=15D, XRange=1D4/[15,2.5])

  <span class="comments">; plot the spectrum</span>
  spectrum->Plot

  <span class="comments">; clean up</span>
  OBJ_DESTROY,[spectrum, transitions, pahdb]

  <span class="comments">; reset under/overflow errors</span>
  !EXCEPT = e

END
</code>
      </div>
    </div>
  </body>
</html>